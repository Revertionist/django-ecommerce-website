{% extends 'main/base.html' %}

{% block title %}
{{ product.title }}
{% endblock %}

{% block content %}
{% include 'main/components/navbar.html' %}
<div class="container  purchase-card" style="margin-top: 30px;">
    <div class="card mb-3">
        <img class="card-img-top" src="{{ product.image.url }}" alt="Card image cap" data-bs-theme="light">
        <div class="card-body">
            <br>
            <h1 class="card-title">{{ product.title }}
            </h1>
            <p class="card-text">{{ product.description }}</p>
            <h1>
                <p class="card-text"><small class="text-muted">Rs. {{ product.price }}</small></p>
            </h1>
            {%if product.stock > 0 %}
                <a id="buy_now_button" href="/checkout/{{ product.id }}" class="btn btn-primary">Buy</a>
            {% else %}
                <a id="buy_now_button" class="btn btn-primary disabled">Buy</a>
            {% endif %}
            <!-- /confirmation/{{ product.id }} -->
        </div>
        <script src="https://js.stripe.com/v3/"></script>

        <script>
            var stripe = Stripe('{{ stripe_public_key }}');
            const buy_now_button = document.querySelector('#buy_now_button')
            
            buy_now_button.addEventListner('click', event => {
                stripe.redirectToCheckout({

                    sessionId: '{{ session_id }}'

                }).then(function (result) {

                });
            })
        </script>
    </div>
</div>
<style>
    .purchase-card {
        height: 20%;
        width: 30%;
        object-fit: scale-down;
    }
</style>
{% endblock %}